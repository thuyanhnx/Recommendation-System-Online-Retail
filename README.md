# Recommendation System on Online Retail

Dataset: https://archive.ics.uci.edu/dataset/352/online+retail
Tech Stacks: PySpark, Python, Spark MLlib (Tokenizer, StopWordsRemover, HashingTF, IDF)

I led this project and collaborated with two other members for the Big Data course in the MS in Data Science program at the University of Michigan – Dearborn. This project explores and compares the performance of **three recommendation approaches—content-based filtering, item-based collaborative filtering, and user-based collaborative filtering—**using real-world online retail transaction data. The objective is to generate top-3 personalized product recommendations for each customer and evaluate how different modeling strategies perform under the same experimental setup.

To ensure realistic evaluation, the dataset was first cleaned and preprocessed, and a time-based train/test split was applied at the customer level. For each customer, the most recent invoice was reserved as the test set, while all earlier transactions were used for training. An implicit feedback signal was engineered by defining user–item ratings based on purchasing behavior. For the content-based model, the rating was defined as the number of distinct invoices in which a customer purchased a given item. For collaborative filtering models, ratings were computed using a frequency-based score combined with a log-transformed purchase quantity, followed by mean-centering to normalize user preferences.

In the content-based recommendation pipeline, item representations were constructed from product textual descriptions. Each product description was tokenized, filtered using stop-word removal, and transformed into TF-IDF feature vectors using Spark’s HashingTF and IDF. These vectors served as item profiles capturing product characteristics. User profiles were then created by computing a rating-weighted average of the TF-IDF vectors of items previously purchased by each user. Recommendations were generated by computing cosine similarity between user and item vectors using Spark-native vector operations, with precomputed norms for efficient similarity calculation. Candidate items excluded products already purchased in the training set, and the top 3 items with the highest similarity scores were selected for each user.

For the item-based and user-based collaborative filtering models, a mean-centered user–item interaction matrix was constructed. Pairwise cosine similarity was computed to identify similar users or similar products. Predicted user–item scores were obtained using a similarity-weighted average of neighboring ratings, and the top 3 items with the highest predicted scores were recommended for each customer.

Model performance was evaluated using both error-based and ranking-based metrics. RMSE was used to measure the accuracy of predicted ratings, while Precision@3 assessed how often recommended items appeared in the user’s held-out test purchases. This comparative evaluation highlights the strengths and limitations of each approach in capturing user preferences and producing relevant recommendations in an online retail setting.
