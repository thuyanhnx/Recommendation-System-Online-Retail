# Recommendation System on Online Retail

- Dataset: https://archive.ics.uci.edu/dataset/352/online+retail
- Tech Stacks: PySpark, Python, Spark MLlib (Tokenizer, StopWordsRemover, HashingTF, IDF)

![RecSys-Description](https://github.com/user-attachments/assets/6254ccf2-ec45-4ec8-b922-1723e7884c3c)


I led this project and collaborated with two other members for a Big Data course in the MS in Data Science program at the University of Michigan – Dearborn. This project explores and compares the performance of **three recommendation approaches—content-based filtering, item-based collaborative filtering, and user-based collaborative filtering** using real-world online retail transaction data. 

* **Objective**:
  * Generate top-3 personalized product recommendations for each customer
  * Evaluate how different modeling strategies perform.
 
* Methodology
  1. Clean & Preprocess data
  2. Experiment Design: time-based train/test split
  3. Rating metric design
     * Content-based: the rating was defined as the number of distinct invoices in which a customer purchased a given item
     * Collaborative Filtering: rating = log(quantity) + frequency, followed by **scaled** to a scale of 1-10 and **normalization** by mean-centering.
  4. Implement the the rec systems:
     * **Content-based**: item representations were constructed from product textual descriptions. Each product description was tokenized, filtered using stop-word removal, and transformed into TF-IDF feature vectors using Spark’s **Hashing TF and IDF**. These vectors served as item profiles capturing product characteristics. User profiles were then created by computing a rating-weighted average of the TF-IDF vectors of items previously purchased by each user. Recommendations were generated by computing cosine similarity between user and item vectors using Spark-native vector operations, with precomputed norms for efficient similarity calculation. Candidate items excluded products already purchased in the training set, and the top 3 items with the highest similarity scores were selected for each user.
     * For the **item-based and user-based collaborative filtering** models, a **mean-centered** user–item interaction matrix was constructed. Pairwise cosine similarity was computed to identify similar users or similar products. Predicted user–item scores were obtained using a similarity-weighted average of neighboring ratings, and the top 3 items with the highest predicted scores were recommended for each customer.
  5. Evaluation
     * RMSE
     * Precision
     * Coverage percentage
